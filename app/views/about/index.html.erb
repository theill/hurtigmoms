<%- @meta = { :title => 'Bogføring for den lille virksomhed', :description => '', :blank_header => true } -%>

<%- if signed_in? -%>
	<h1>Oversigt</h1>
	
	<%- if @action_required -%>
		<div class="action-required">
			<%- if @incomplete_transactions.any? -%>
				<p>
					Du har <%= link_to('transaktioner', fiscal_year_transactions_path(current_user.active_fiscal_year)) %> der kræver handling.
				</p>
			<%- end -%>
			
			<%- if @transactions_with_wrong_fiscal_year.any? -%>
				<p>
					Du har <%= link_to(pluralize(@transactions_with_wrong_fiscal_year.length, 'transaktion', 'transaktioner'), fiscal_year_transactions_path(current_user.active_fiscal_year), :id => 'display-transactions') %> 
					der har en faktura- eller betalings-dato uden for dit valgte regnskabsår.
				</p>
				<div id="transactions-with-wrong-fiscal-year" style="display: none">
					<ul>
						<% @transactions_with_wrong_fiscal_year.each do |t| %>
							<li><%=h t.created_at.strftime("%d/%m-%Y") + ' - ' + t.note %></li>
						<%- end -%>
					</ul>
				</div>
				
				<%- if @other_fiscal_years.any? -%>
					<p>
						Vælg det regnskabsår du ønsker at flytte transaktionerne til.
					</p>
					<%= form_tag(auto_correct_fiscal_year_transactions_path(current_user.active_fiscal_year)) %>
						<ul>
							<%- @other_fiscal_years.each do |fy| -%>
								<li><%= radio_button_tag 'corrected_fiscal_year_id', fy.id %><label for="<%= 'corrected_fiscal_year_id_' + fy.id.to_s %>"><%=h fy.name %></label></li>
							<%- end -%>
						</ul>
						<%= submit_tag "Flyt" %>
					</form>
				<%- else -%>
					<p>
						Ønsker du at oprette et nyt regnskabsår og flytte disse transaktioner over?
					</p>
					<%= form_tag(auto_correct_fiscal_year_transactions_path(current_user.active_fiscal_year)) %>
						<%= hidden_field_tag 'corrected_fiscal_year_id', '-1' %>
						<%= submit_tag "Opret &amp; flyt" %>
					</form>
				<%- end -%>
			<%- end -%>
			
			<%- if @transactions_without_related_transactions.any? -%>
				<p>
					Du har <%= pluralize(@transactions_without_related_transactions.length, 'betalingstransaktion', 'betalingstransaktioner') %>
					der ikke har en tilhørende købs- eller salgstransaktion. For at 
					lette arbejdet med bankafstemningen, er det ikke muligt at bogføre
					forud hvorfor det derfor er nødvendigt at afstemme disse 
					transaktioner først.
				</p>
				<%= link_to('Vis transaktionerne', '#', :id => 'display-transactions-without-relations') %>
				<div id="transactions-without-relations" style="display: none">
					<ul>
						<% @transactions_without_related_transactions.each do |t| %>
							<li><%=h t.created_at.strftime("%d/%m-%Y") + ' - ' + t.note %></li>
						<%- end -%>
					</ul>
				</div>
			<%- end -%>
		</div>
	<%- else -%>
		<div class="blank-slate">
			<p>
				Du har ingen beskeder eller punkter der kræver handling.
			</p>
		</div>
	<%- end -%>
	
	<%- if @latest_import && (1.month.ago > @latest_import.created_at) -%>
	  <div>
	    <p>
	      Det er mere end een måned siden du importerede dine kontoudtog fra banken.
	    </p>
	    <p>
	      For at lette bogføringen anbefales det, at importere kontoudtog jævnligt
	      så hvis du henter et nyt kontoudtog fra din bank, kan du genbruge dine 
	      indstillinger fra sidste importering og måske gøre det med det samme.
	    </p>
	  </div>
	<%- end -%>

	<div class="quick-start">
		<h3>Kom hurtigt i gang</h3>
		<ol>
			<li><%= link_to('Tilføj indtægter og udgifter', fiscal_year_transactions_path(current_user.active_fiscal_year)) %></li>
			<!-- <li><%= link_to('Tilpas din kontoplan', accounts_path) %></li> -->
			<li><%= link_to('Konfigurer dine debitorer', customers_path) %></li>
			<!-- <li><%= link_to('Indlæs dine kontoudtog', new_posting_import_path) %></li> -->
		</ol>
	</div>

	<%- content_for :js do -%>
		$("#display-transactions").live("click", function() {
			$("#transactions-with-wrong-fiscal-year").slideDown();
			return false;
		});
		$("#display-transactions-without-relations").live("click", function() {
			$(this).hide();
			$("#transactions-without-relations").slideDown();
			return false;
		});
	<%- end -%>
	
<%- else -%>

	<div class="intro">
		<div class="container_12">
			<div class="grid_12">
				<h1>hurtigmoms</h1>
				<h3>effektiv og let bogføring for den lille virksomhed</h3>
			</div>
		</div>
	</div>
	
	<div class="container_12">
		<div class="grid_7">
		  <div class="callout">
		    <p>
					Har du behov for et online bogføringssystem der ikke kræver, man 
					er revisor? Så er <b>hurtigmoms</b> lige noget for dig!
				</p>
				<p>
					Du behøver ikke at have kendskab til kassekladde, afsteming, dobbelt
					bogholderi princippet, etc for at benytte hurtigmoms. Du ledes 
					igennem alle led nødvendigt for at få lavet et fuldt momsregnskab 
					eller endda årsrapport.
				</p>
		  </div>
		</div>
		<div class="grid_5">
			<div class="signup-box">
				<h2>Prøv det gratis i 60 dage</h2>
				<p>
					Hurtigmoms er i <b>beta</b> og det er derfor gratis at tilmelde sig. 
					Du kan enten vælge at:
				</p>
				<ol>
					<li>sende et bilag på <code>bilag@hurtigmoms.dk</code> og 
					vi opretter en konto til dig inden for et minut.</li>
					<li>benytter vores <%= link_to('tilmeldingsformular', sign_up_path) %></li>
				</ol>
				<p>
					Allerede bruger? <%= link_to("Log ind", new_session_path) %> med det
					samme.
				</p>
			</div>
		</div>
		
		<div class="clear"></div>
		
		<!-- <div class="grid_4"><div class="shot"><a class="elastic" href="/images/transactions.png" rel="frontpage-images"><img src="/images/transactions-thumbnail.png" width="300" alt="Visning af alle transaktioner" /></a></div></div>
		<div class="grid_4"><div class="shot"><a class="elastic" href="/images/transactions.png" rel="frontpage-images"><img src="/images/transactions-thumbnail.png" width="300" /></a></div></div>
		<div class="grid_4"><div class="shot"><a class="elastic" href="/images/transactions.png" rel="frontpage-images"><img src="/images/transactions-thumbnail.png" width="300" /></a></div></div>
		
		<div class="clear"></div> -->
		
		<div class="grid_12">
			<!--
			<h4>Unik understøttelse for emails</h4>
			<p>
				Hurtigmoms har en unik funktion der gør det muligt at kigge intelligent på 
				mails du videresender til os. Hvis du fx sender din månedlige "Basecamp" 
				faktura udtrækkes automatisk faktura dato, beløb, valuta samt beskrivelse 
				fra mailen og denne indsættes som en ny postering på dit regnskab. Vi sætter
				endda typen som værende "Varekøb, udland" så moms ikke bliver tillagt.
			</p>
	
			<p>
			  Indtil videre understøttes Harvest, GitHub, Campaign Monitor, GratisDNS, 
			  Basecamp og Spotify, men der tilføjes nye hver dag. Skriv til os hvis du 
			  ønsker at din mail kan forstås af hurtigmoms.
			</p>
			-->
		</div>

		<div class="clear"></div>
		
		<div id="f">
			Udviklet af <%= link_to('Commanigy', 'http://commanigy.com/') %> 
		</div>
		
		<%- content_for :js do -%>
			$("a.elastic").fancybox({
				"titleShow"     : false,
				"transitionIn"	: "elastic",
				"transitionOut"	: "elastic"
			});
		<%- end -%>
		
	</div>
<%- end -%>